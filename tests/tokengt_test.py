import sys
from gym.spaces import Dict, Box, Discrete
import numpy as np
import torch

sys.path.append(sys.path[0] + "/..")
sys.path.append(sys.path[0] + "/../models")

from models.features_extractor_tokengt import FeaturesExtractorTokenGT
from stable_baselines3.common.utils import obs_as_tensor
import torch


def get_gym_obs():
    obs = {
        "edge_index": torch.LongTensor(
            [
                [
                    [0, 1, 4, 5, 8, 9, 12, 13, 2, 6, 10, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [1, 2, 5, 6, 9, 10, 13, 14, 3, 7, 11, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
                [
                    [0, 1, 4, 5, 8, 9, 12, 13, 2, 6, 10, 14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [1, 2, 5, 6, 9, 10, 13, 14, 3, 7, 11, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                ],
            ]
        ),
        "features": torch.Tensor(
            [
                [
                    [
                        0.0000,
                        -1.0000,
                        0.0515,
                        0.0772,
                        0.0551,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.1556,
                        0.2333,
                        0.1667,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        1.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        -1.0000,
                        0.3346,
                        0.6029,
                        0.3493,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.0846,
                        0.1618,
                        0.0919,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.1000,
                        0.2556,
                        0.1111,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        0.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        -1.0000,
                        0.4191,
                        0.7169,
                        0.4338,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2022,
                        0.3125,
                        0.2132,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.3556,
                        0.4556,
                        0.3667,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        0.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        -1.0000,
                        0.4816,
                        0.7316,
                        0.4963,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.4111,
                        0.6222,
                        0.4222,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        0.0000,
                        -1.0000,
                        0.3382,
                        0.5184,
                        0.3529,
                        -1.0000,
                        0.4963,
                        0.8346,
                        0.5110,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.0993,
                        0.1949,
                        0.1029,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.3000,
                        0.5889,
                        0.3111,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        1.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        -1.0000,
                        0.4816,
                        0.7316,
                        0.4963,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2022,
                        0.3529,
                        0.2096,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.3111,
                        0.4778,
                        0.3222,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        0.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        -1.0000,
                        0.4191,
                        0.7169,
                        0.4338,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2904,
                        0.4890,
                        0.3015,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.2667,
                        0.4111,
                        0.2778,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        0.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        -1.0000,
                        0.3346,
                        0.6029,
                        0.3493,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.4000,
                        0.4222,
                        0.4111,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        0.0000,
                        -1.0000,
                        0.4228,
                        0.6287,
                        0.4375,
                        -1.0000,
                        0.4963,
                        0.8346,
                        0.5110,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.0331,
                        0.2059,
                        0.0368,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.1000,
                        0.6222,
                        0.1111,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        1.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        -1.0000,
                        0.3346,
                        0.6029,
                        0.3493,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.1654,
                        0.4265,
                        0.1728,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.4000,
                        0.6667,
                        0.4111,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        0.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        -1.0000,
                        0.4816,
                        0.7316,
                        0.4963,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2941,
                        0.6691,
                        0.3051,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.3889,
                        0.7333,
                        0.4000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        0.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        -1.0000,
                        0.4191,
                        0.7169,
                        0.4338,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.4556,
                        1.0000,
                        0.4667,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        0.0000,
                        -1.0000,
                        0.4449,
                        1.0000,
                        0.4596,
                        -1.0000,
                        0.4963,
                        0.8346,
                        0.5110,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.1618,
                        0.1838,
                        0.1654,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.4889,
                        0.5556,
                        0.5000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        1.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        -1.0000,
                        0.3346,
                        0.6029,
                        0.3493,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2941,
                        0.3493,
                        0.3015,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.4000,
                        0.5000,
                        0.4111,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        0.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        -1.0000,
                        0.4816,
                        0.7316,
                        0.4963,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.4485,
                        0.5809,
                        0.4596,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.4667,
                        0.7000,
                        0.4778,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        0.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        -1.0000,
                        0.4191,
                        0.7169,
                        0.4338,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.2333,
                        0.4778,
                        0.2444,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        0.0000,
                        -1.0000,
                        0.5257,
                        0.7390,
                        0.5404,
                        -1.0000,
                        0.4963,
                        0.8346,
                        0.5110,
                    ],
                ],
                [
                    [
                        0.0000,
                        -1.0000,
                        0.0686,
                        0.0830,
                        0.0722,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.2346,
                        0.2840,
                        0.2469,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        1.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        -1.0000,
                        0.3718,
                        0.6895,
                        0.3863,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2166,
                        0.3682,
                        0.2238,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.5062,
                        0.9753,
                        0.5185,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        0.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        -1.0000,
                        0.5271,
                        1.0000,
                        0.5415,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.3177,
                        0.4765,
                        0.3285,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.3457,
                        0.3704,
                        0.3580,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        0.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        -1.0000,
                        0.4765,
                        0.7184,
                        0.4910,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.1975,
                        0.4074,
                        0.2099,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        0.0000,
                        -1.0000,
                        0.3755,
                        0.5957,
                        0.3899,
                        -1.0000,
                        0.4982,
                        0.7690,
                        0.5126,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.1588,
                        0.2383,
                        0.1625,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.5432,
                        0.8148,
                        0.5556,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        1.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        -1.0000,
                        0.5271,
                        1.0000,
                        0.5415,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2599,
                        0.4477,
                        0.2671,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.3457,
                        0.7160,
                        0.3580,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        0.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        -1.0000,
                        0.4765,
                        0.7184,
                        0.4910,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.3177,
                        0.6029,
                        0.3285,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.1975,
                        0.5309,
                        0.2099,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        0.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        -1.0000,
                        0.3718,
                        0.6895,
                        0.3863,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.5432,
                        0.7654,
                        0.5556,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        0.0000,
                        -1.0000,
                        0.4765,
                        0.8267,
                        0.4910,
                        -1.0000,
                        0.4982,
                        0.7690,
                        0.5126,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.1625,
                        0.1769,
                        0.1661,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.5556,
                        0.6049,
                        0.5679,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        1.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        -1.0000,
                        0.4982,
                        0.7690,
                        0.5126,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2599,
                        0.4079,
                        0.2671,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.3333,
                        0.7901,
                        0.3457,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        0.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        -1.0000,
                        0.3718,
                        0.6895,
                        0.3863,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.3971,
                        0.5704,
                        0.4079,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.4691,
                        0.5556,
                        0.4815,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        0.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        -1.0000,
                        0.4765,
                        0.7184,
                        0.4910,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.2222,
                        0.6296,
                        0.2346,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        0.0000,
                        -1.0000,
                        0.4621,
                        0.7545,
                        0.4765,
                        -1.0000,
                        0.5271,
                        1.0000,
                        0.5415,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.1480,
                        0.2202,
                        0.1516,
                        0.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.5062,
                        0.7531,
                        0.5185,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        1.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        -1.0000,
                        0.3718,
                        0.6895,
                        0.3863,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.2671,
                        0.4693,
                        0.2744,
                        2.0000,
                        2.0000,
                        2.0000,
                        2.0000,
                        -1.0000,
                        0.4074,
                        0.8519,
                        0.4198,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        0.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        -1.0000,
                        0.4982,
                        0.7690,
                        0.5126,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.4043,
                        0.7076,
                        0.4152,
                        3.0000,
                        3.0000,
                        3.0000,
                        3.0000,
                        -1.0000,
                        0.4691,
                        0.8148,
                        0.4815,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        0.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        -1.0000,
                        0.4765,
                        0.7184,
                        0.4910,
                    ],
                    [
                        0.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        1.0000,
                        1.0000,
                        1.0000,
                        1.0000,
                        -1.0000,
                        0.5309,
                        1.0000,
                        0.5432,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        -1.0000,
                        0.0000,
                        0.0000,
                        0.0000,
                        1.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        0.0000,
                        -1.0000,
                        0.5596,
                        1.0000,
                        0.5740,
                        -1.0000,
                        0.5271,
                        1.0000,
                        0.5415,
                    ],
                ],
            ]
        ),
        "n_edges": torch.LongTensor([12, 12]),
        "n_jobs": torch.LongTensor([4, 4]),
        "n_machines": torch.LongTensor([4, 4]),
        "n_nodes": torch.LongTensor([16, 16]),
    }

    return obs


def get_fe_tokengt():
    features_extractor = FeaturesExtractorTokenGT(
        observation_space=Dict(
            {
                "n_jobs": Discrete(4),
                "n_machines": Discrete(4),
                "n_nodes": Discrete(16),
                "n_edges": Discrete(32),
                "features": Box(0, 1, shape=(16, 35)),
                "edge_index": Box(0, 1, shape=(2, 32), dtype=np.int64),
                "mask": Box(0, 1, shape=(16,), dtype=np.int64),
            }
        ),
        input_dim_features_extractor=35,
        device=torch.device("cpu"),
        max_n_nodes=16,
        max_n_machines=4,
        lap_node_id=True,
        lap_node_id_k=16,
        lap_node_id_sign_flip=True,
        activation_fn=torch.nn.ReLU,
        # orf_node_id=True,
        # orf_node_id_dim=64,
        type_id=True,
        performer=True,
        # mandatory wih performer
        attention_dropout=0.0,
    )
    return features_extractor


def main():
    fe = get_fe_tokengt()
    fe(get_gym_obs())


if __name__ == "__main__":
    main()
